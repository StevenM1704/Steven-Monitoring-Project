# Steven Monitoring Project

A Kubernetes-based monitoring solution that collects, stores, alerts, and visualizes URL availability and latency metrics using Flask, Prometheus, Alertmanager, and Grafana.
Designed for macOS using Colima as the container and Kubernetes runtime.

# Overview

Steven Monitoring Project is an end-to-end monitoring stack built as part of an SRE final project.
It includes:

A Python Flask application that monitors URLs and exposes Prometheus metrics.

Background worker for periodic URL health and latency checks.

Prometheus scraping the application metrics every 5 seconds.

Alertmanager handling alert routing and notifications.

Grafana with full provisioning (datasource + dashboards).

Kubernetes deployments and services for each component (Prometheus, Alertmanager, Grafana, Flask app).

All components support both Docker Compose (local testing) and Kubernetes (production-ready).

# Architecture
Components

Flask Monitoring App
Endpoints:
/metrics, /add, /urls
Collects URL up/down status, latency, failures, and total checks.

Prometheus
Scrapes application metrics and evaluates alerting rules.

Alertmanager
Handles alerts generated by Prometheus (website down, failures, etc.).

Grafana
Visualizes URL health and latency through an auto-provisioned dashboard.

Kubernetes (Colima)
Runs the full stack through Deployments, Services, and ConfigMaps.

# Data Flow

Flask app performs URL checks.

Metrics are exposed at /metrics.

Prometheus scrapes the metrics.

Alertmanager triggers alerts when a website is down.

Grafana displays real-time status and graphs.

# Features

URL health and latency monitoring.

Prometheus-formatted metrics.

Auto-provisioned Grafana dashboards.

Alerting through Alertmanager.

Kubernetes-ready manifests.

Configurable URL list.

Fully reproducible deployment environment.

# Technologies

Python 3.9

Flask

prometheus_client

Docker / Docker Compose

Kubernetes

Colima

Prometheus

Alertmanager

Grafana

# Local Deployment (Docker Compose)
Requirements

Colima or Docker Desktop

Docker CLI + compose plugin

Python 3.9 (optional for local testing)

# Start the stack
docker compose -f docker-compose.yaml up --build

# Verify services

App → http://localhost:5000/

Metrics → http://localhost:5000/metrics

Prometheus → http://localhost:9090/targets

Grafana → http://localhost:3000

Default Grafana credentials:

admin / admin

# Add a URL
curl "http://localhost:5000/add?url=https://www.google.com"

# List monitored URLs
curl http://localhost:5000/urls

# View metrics
curl http://localhost:5000/metrics

# Kubernetes Deployment (Colima)
Requirements

Colima with Kubernetes enabled

kubectl

Docker CLI

# Start Colima with Kubernetes
colima start --kubernetes

# Check cluster
kubectl get nodes

# Build application image
docker build -t steven-monitoring-app .

# Load the image into Colima
docker save steven-monitoring-app:latest -o steven.tar
colima ssh
sudo ctr -n k8s.io images import steven.tar
exit

# Apply manifests
kubectl apply -f manifests/

# Check pods
kubectl get pods

# Port-forward services

App

kubectl port-forward svc/steven-monitoring-service 5000:5000


Prometheus

kubectl port-forward svc/steven-prometheus 9090:9090


Grafana

kubectl port-forward svc/steven-grafana 3000:3000


Alertmanager

kubectl port-forward svc/steven-alertmanager 9093:9093

# Project Structure
Steven-Monitoring-Project/
│
├── app/
│   ├── _init_.py
│   ├── main.py
│   └── metrics.py
│
├── grafana-provisioning/
│   ├── datasources/
│   │   └── datasource.yaml
│   └── dashboards/
│       ├── dashboard.yaml
│       └── dashboard.json
│
├── manifests/
│   ├── deployment.yaml
│   ├── service.yaml
│   ├── prometheus.yaml
│   ├── alertmanager.yaml
│   ├── alert-rules.yaml
│   └── grafana.yaml
│
├── docker-compose.yaml
├── Dockerfile
├── requirements.txt
└── README.md

# Metrics Exposed
url_up

1 = URL reachable
0 = unreachable

url_latency_seconds

Latency in seconds for the last HTTP request.

url_checks_total

Total number of checks performed.

url_failures_total

Total failures encountered.

# Alerting (Alertmanager)

Alertmanager receives alerts from Prometheus based on rules defined in alert-rules.yaml.

Example rule:
alert: WebsiteDown
expr: url_up == 0
for: 30s
severity: critical

Alertmanager supports:

Slack

Email SMTP

PagerDuty

Webhooks

Teams

Custom receivers

(Default configuration routes alerts to the Alertmanager UI.)

Access UI:

http://localhost:9093

# Troubleshooting
Grafana shows “No data”

Check Prometheus target state: http://localhost:9090/targets

Verify datasource URL: http://steven-prometheus:9090

Confirm Grafana provisioning directory is correctly mounted.

Prometheus cannot scrape the app

Ensure service name matches: steven-monitoring-service

Check app pod logs.

Metrics empty

Add URLs:

curl "http://localhost:5000/add?url=https://www.google.com"

# License

MIT License.

# Contributing

Fork the repository, create a feature branch, and submit a pull request with clear changes and testing steps.